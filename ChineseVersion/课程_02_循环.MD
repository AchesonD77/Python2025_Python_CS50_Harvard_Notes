# 讲义 2 — 循环（Loops）

## 目录
- [循环概念](#循环概念)
- [while 循环](#while-循环)
- [for 循环](#for-循环)
- [结合用户输入改进](#结合用户输入改进)
- [更多关于列表](#更多关于列表)
- [长度 `len`](#长度-len)
- [字典 `dict`](#字典-dict)
- [马里奥示例](#马里奥示例)
- [小结](#小结)

---

## 循环概念

- **循环**本质上就是*把某件事重复做*。
- 在终端新建 `cat.py`，示例：

```python
print("meow")
print("meow")
print("meow")
```
- 通过输入 python cat.py 来运行此代码，您会注意到程序喵喵叫了三次。
- 作为一名程序员，在开发过程中，你需要考虑如何改进那些一遍又一遍输入相同代码的地方。想象一下，一个人可能想“喵喵”叫 500 次。一遍又一遍地输入同一个 print("meow") 表达式是否合乎逻辑？


- 重复粘贴不可扩展（想象要输出 500 次），**循环**能让代码块重复执行。

---

## while 循环

- **`while`** 在条件为 `True` 时反复执行代码块。
- 容易出错的写法（会**死循环**）：

```python
i = 3
while i != 0:
    print("meow")
```
- 当你陷入一个永远执行的循环时，可以按下键盘上的 Ctrl+C 来中断循环。
  

- 修正：在循环体内改变循环变量：

```python
i = 3
while i != 0:
    print("meow")
    i = i - 1
```

- 更好的习惯：从 **0** 开始计数并向上迭代：

```python
i = 1
while i <= 3:
    print("meow")
    i = i + 1
```

- 最佳：从 0 开始并使用 `i += 1`：

```python
i = 0
while i < 3:
    print("meow")
    i += 1
```

> 循环计数到 *3 之前* 结束。

---

## for 循环

- **`for`** 会遍历 **列表** 或其他可迭代对象。
- 列表示例：

```python
for i in [0, 1, 2]:
    print("meow")
```

- 更简洁：`range(3)` 自动产生 `0,1,2`：

```python
for i in range(3):
    print("meow")
```

- 若循环变量不使用，采用**下划线**：

```python
for _ in range(3):
    print("meow")
```

- 字符串相乘可重复：

```python
print("meow" * 3)
```

- 每次输出后换行：

```python
print("meow\n" * 3, end="")
```

---

## 结合用户输入改进

- 用循环校验输入；例如，要求 **`n >= 0`**：
- Python 中的一个常见范例是使用 while 循环来验证用户的输入。
- 例如，让我们尝试提示用户输入大于或等于 0 的数字：

```python
while True:
    n = int(input("What's n? "))
    if n < 0:
        continue
    else:
        break
```
- 请注意，我们在 Python 中引入了两个新关键字： continue 和 break，continue 明确指示 Python 进入循环的下一次迭代。break 则指示 Python 在完成所有迭代之前提前“跳出”循环。



- 在本例中 `continue` 是**冗余**的，可简化为：

```python
while True:
    n = int(input("What's n? "))
    if n > 0:
        break

for _ in range(n):
    print("meow")
```

- 封装成**函数**并使用 `return`：

```python
def main():
    meow(get_number())

def get_number():
    while True:
        n = int(input("What's n? "))
        if n > 0:
            return n

def meow(n):
    for _ in range(n):
        print("meow")

main()
```

---

## 更多关于列表
- 想象一下著名的哈利波特世界中的霍格沃茨世界。

```python
students = ["Hermione", "Harry", "Ron"]

print(students[0])
print(students[1])
print(students[2])
```
- 注意，我们有一个如上所示的学生 list ，其中包含学生姓名。然后，我们打印位于第 0 个位置的学生“Hermione”。其他每个学生的信息也一并打印出来。
  
- 直接遍历列表更简洁：

```python
students = ["Hermione", "Harry", "Ron"]

for student in students:
    print(student)
```
- 请注意，对于 students 列表中的每个 student ，它都会按预期打印该学生。您可能想知道为什么我们没有像之前讨论的那样使用 _ 标记。我们选择不这样做，因为我们的代码中明确使用了 student 。


- 您可以在 Python 的列表文档中了解更多信息。(https://docs.python.org/3/tutorial/datastructures.html#more-on-lists)

---

## 长度 `len`

- 使用 **`len`** 获取长度并打印位置与姓名：

```python
students = ["Hermione", "Harry", "Ron"]

for i in range(len(students)):
    print(i + 1, students[i])
```
- 请注意，执行此代码不仅可以使用 i + 1 获取每个学生的位置加一， len 可以打印每个学生的姓名。len 允许您动态查看学生名单的长度，无论它增长多少。
  

- <mark>**建议**</mark>：如果不需要索引，优先使用 `for … in …` 直接遍历。

- 您可以在 Python 的 len 文档中了解更多信息。(https://docs.python.org/3/library/functions.html?highlight=len#len)
---

## 字典 `dict`

- **`dict`** 把键和值关联起来。
  
```
dict 或字典是一种数据结构，可让您将键与值关联起来。
list 是多个值的列表，而 dict 将键与值关联起来。

```
- 平行列表（不推荐，易错）：

```python
students = ["Hermione", "Harry", "Ron", "Draco"]
houses = ["Gryffindor", "Gryffindor", "Gryffindor", "Slytherin"]
```
- 请注意，我们可以保证这些列表始终保持有序。 students 列表中第一个位置的个人与 houses 列表中第一个位置的房屋相关联，依此类推。然而，随着列表的增长，这可能会变得非常繁琐！
  

- 更好：使用字典：

```python
students = {
    "Hermione": "Gryffindor",
    "Harry": "Gryffindor",
    "Ron": "Gryffindor",
    "Draco": "Slytherin",
}
print(students["Hermione"])
print(students["Harry"])
print(students["Ron"])
print(students["Draco"])
```
- 注意我们如何使用 {} 花括号来创建字典。list 使用数字来遍历 list ，而 dict 允许我们使用单词。



- 仅遍历 键：

```python
for student in students:
    print(student)
```
- 注意， students[student] 会根据每个学生的键值找到他们房子对应的值。


- 同时输出键和值（用 `sep=", "` 优雅分隔）：

```python
for student in students:
    print(student, students[student], sep=", ")
```


- 更丰富的数据：**字典列表**（每个学生多个字段）：

```python
students = [
    {"name": "Hermione", "house": "Gryffindor", "patronus": "Otter"},
    {"name": "Harry", "house": "Gryffindor", "patronus": "Stag"},
    {"name": "Ron", "house": "Gryffindor", "patronus": "Jack Russell terrier"},
    {"name": "Draco", "house": "Slytherin", "patronus": None},
]

for student in students:
    print(student["name"], student["house"], student["patronus"], sep=", ")
```
- 注意这段代码是如何创建一个 dict list 的。名为 students list 包含四个 dicts ：每个学生对应一个字典。另外，请注意 Python 有一个特殊的 None 标记，表示没有与键关联的值。
- 注意 for 循环如何遍历名为 students list 中的每个 dict 


- 您可以在 Python 的 dict 文档中了解更多信息。(https://docs.python.org/3/tutorial/datastructures.html#dictionaries)

---

## 马里奥示例

- 还记得经典游戏《马里奥》里有个英雄会跳过砖块吗？让我们创建一个文本表示来描述这个游戏。
- 先打印砖块：

```python
print("#")
print("#")
print("#")
```

- 用 **for** 循环替换重复：

```python
for _ in range(3):
    print("#")
```

- 抽象成函数打印**列**：

```python
def main():
    print_column(3)

def print_column(height):
    for _ in range(height):
        print("#")

main()
```

- 打印**行**：

```python
def main():
    print_row(4)

def print_row(width):
    print("?" * width)

main()
```

- 行 + 列（嵌套循环）打印正方形：

```python
def main():
    print_square(3)

def print_square(size):
    # 外层：每一行
    for i in range(size):
        # 内层：每个砖块
        for j in range(size):
            print("#", end="")
        # 换行
        print()

main()
```

- 进一步抽象（结尾代码一致）：

```python
def main():
    print_square(3)


def print_square(size):
    for i in range(size):
        print_row(size)


def print_row(width):
    print("#" * width)


main()
```

---

## 小结

你现在在 Python 技能树上又多了一项能力。本讲我们讨论了：

- **<mark>循环</mark>**
- **`while`**
- **`for`**
- **`len`**
- **`list`**
- **`dict`**
